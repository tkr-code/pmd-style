{% extends 'admin/base.html.twig' %}

{% import "macros/link.html.twig" as link %}

{% block title %}PaiementFormationDispensee
{% endblock %}

{% block body %}

	<div class="row mb-3">
		<div class="col-lg-12 col-md-12 col-12">
			<div class="card card-outline card-dark">
				<div class="card-header">
					Details du paiement concernant le module
					<b class="text-danger">{{formation_dispensee.module.abreviation}}</b>
					pour la     classe
					<b class="text-danger">{{classe.abreviation}}</b>
					de niveau
					<b class="text-danger">{{classe.niveauEtude}}</b>
					dans le centre de formation
					<b class="text-danger">
						{{centre_formation.sigle}}
					</b>
					pour un volume horaire de
					<b class="text-danger">
						{{formation_dispensee.volumeHoraire}}
						H
					</b>
					à la valeur
					<b class="text-danger">
						{{formation_dispensee.valeurHeure|number_format(0, ',', ' ')}}
					</b>
					f l'heure
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-md-6">
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Abréviation Module</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">{{formation_dispensee.module.abreviation}}</p>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Description Module</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">{{formation_dispensee.module.designation}}</p>
								</div>
							</div>
							<hr>

							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Niveau Etude</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">{{classe.niveauEtude}}</p>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Classe
									</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">{{classe.designation}}
										{{classe.abreviation}}</p>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Contenant
									</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">{{classe.nombreEtudiant}}</p>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Etat formation</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">
										{{ paiement_formation_dispensee.formationDispensee.etat}}
									</p>
								</div>
							</div>
							<hr>
						</div>

						<div class="col-md-6">
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Montant Reçu</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">{{paiement_formation_dispensee.montant|number_format(2,',',' ')}}
										F</p>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Volume Horaire</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">{{formation_dispensee.volumeHoraire}}
										H</p>
								</div>
							</div>
							<hr>
                            <div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Total Heure Effectué</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">{{heure_effectuee}} 
										H</p>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Heure Supplemenatire</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">
										{% if heure_supplemenataire == 0 %}
											Aucune Heure en Supplément
										{% else %}
											{{heure_supplemenataire}}
										{% endif %}
									</p>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Date de paiement</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">
										{{ paiement_formation_dispensee.datePaiement ? paiement_formation_dispensee.datePaiement|date('Y-m-d') : '' }}
									</p>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="col-sm-3">
									<p class="mb-0">Justification</p>
								</div>
								<div class="col-sm-9">
									<p class="text-muted mb-0">
										{{ paiement_formation_dispensee.justification }}
									</p>
								</div>
							</div>
							<hr>
						</div>
					</div>
                    <div class="row">
                        <div class="col text-right">
                            <button type="button" data-toogle="tooltip" title="supprimer le paiement"
                            data-placement="left" class="btn delete_paiement"
                            data-delete="{{paiement_formation_dispensee.id}}"
                            data-path="{{path('paiement_formation_delete',{'id':paiement_formation_dispensee.id})}}"
                            > <i class="fas fa-trash-alt text-danger"></i></button>
                        </div>
                    </div>
				</div>
				<div class="card-footer">
					{{link.back(path('centre_formation_show',{'id':centre_formation.id}),'Voir Le Centre')}}
                    {{link.edit(path('paiement_formation_edit',{'id':paiement_formation_dispensee.id}))}}
				</div>
			</div>
		</div>
	</div>


{% endblock %}
{% block javascripts %}
    <script>
    $(document).ready(function(){
        $(document).on('click','.delete_paiement',function(){
            let id = $(this).data('delete');
            let path = $(this).data('path');

            Swal.fire({
                title: 'Etes vous sur?',
                text: "Attention la suppression est irreversible !",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Oui, Supprimer !',
                cancelButtonText: 'Annuler!'
                }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        url:path,
                        method:'POST',
                        dataType:'JSON',
                        data:{
                            paiement_suppr:'katoula_yaou',
                            id_paie:id
                        },
                        success:function(data){
                     
                            if(data.response == 'success'){
                                Swal.fire(
                                    'Suppression réussie!',
                                    'Le paiement a été supprimé correctement.',
                                    'success'
                                );
                                window.location.href = data.redirecte;
                            }
                            else{
                                swalWithBootstrapButtons.fire(
                                    'Suppression Impossible',
                                    'Impossible de supprimer le paiement, veuillez rééssayer plus tard :)',
                                    'error'
                                 );
                            }
                        }
                    });
                    
                }
            });

        });
    });
    </script>
{% endblock %}
